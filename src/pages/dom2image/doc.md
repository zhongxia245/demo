# JS 生成图片功能分析

目前从社区上来看，主要有两个库可以完成这个功能。 `dom2image` , `html2canvas`.



| 功能                  | PC             | wechat ios                             | wechat android            | IOS                                | Android                | 其他               |
| --------------------- | -------------- | -------------------------------------- | ------------------------- | ---------------------------------- | ---------------------- | ------------------ |
| dom2image下载图片     | 可以下载       | 不可以下载                             | 不可以，只能长按保存      | 不可以                             | 不可以                 | 移动端无法下载文件 |
| dom2image保存为 SVG   | 可以，不失真   | 部分内容丢失，不失真，可以长按保存,svg | 部分内容丢失，不失真，svg | 部分内容丢失，不失真，svg格式      | 可以，不失真，svg      |                    |
| dom2image保存为 PNG   | 可以，失真严重 | 可以，失真严重，可以长按保存,base64    | 无法生成                  | 部分内容丢失，不失真，可以长按保存 | 可以，失真严重，base64 |                    |
| html2canvas保存为 SVG | 可以，稍微失真 | 可以，稍微失真，可以长按保存, base64   | 可以，稍微失真，base64    | 可以，稍微失真,base64              | 可以，稍微失真，base64 |                    |
|                       |                |                                        |                           |                                    |                        |                    |



## 经过一轮测试

1. dom2image , html2canvas 都可以使用本地图片，和七牛图片
2. 内容只有一屏，则不会出现内容丢失的问题，超过一屏则会存在各种丢失内容的问题，丢失内容规律暂时没有找到
3. 她理财 android 分享 base64图片有问题，选择分享微信好友后，没有反应 ， IOS 没有问题
4. 如果页面中存在图片，偶尔会丢失（本地图片，和七牛七牛，都有可能丢失）



采用 html2canvas 方案， 测试可用性， 如果页面内容在一屏之内，测试结果如下

1. wechat ios： 可以
2. webivew ios: 可以， 图片偶尔会丢失，偶发
3. wechat android， 可以
4. webview android： 可以

